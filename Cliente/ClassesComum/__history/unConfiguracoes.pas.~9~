unit unConfiguracoes;

interface

type
  TValidacoes = class
  private
    class function RetirarCaracteres(const ATexto: string;
      const ACaracteres: array of string): string;
  public
    class function VerificarCNPJ(const ANumeroCNPJ: string): Boolean;
  end;

implementation

uses
  StrUtils;

{ TValidacoes }

class function TValidacoes.RetirarCaracteres(const ATexto: string;
  const ACaracteres: array of string): string;
var
  I: Integer;
begin
  Result := ATexto;
  for I := 0 to High(ACaracteres) do
    Result := ReplaceText(Result, ACaracteres[I], '');
end;

class function TValidacoes.VerificarCNPJ(const ANumeroCNPJ: string): Boolean;
var
  Digito1, Digito2: Integer;
  Soma: Longint;
  CNPJ: string;
begin
  Result := False;

  CNPJ := RetirarCaracteres(ANumeroCNPJ, ['.', '/', '-', ' ']);
  while Length(CNPJ) < 14 do
    CNPJ := '0' + CNPJ;

  { calcula o 1o. dígito }
  Soma := (StrToInt(CNPJ[01]) * 5) + (StrToInt(CNPJ[02]) * 4) +
    (StrToInt(CNPJ[03]) * 3) + (StrToInt(CNPJ[04]) * 2) +
    (StrToInt(CNPJ[05]) * 9) + (StrToInt(CNPJ[06]) * 8) +
    (StrToInt(CNPJ[07]) * 7) + (StrToInt(CNPJ[08]) * 6) +
    (StrToInt(CNPJ[09]) * 5) + (StrToInt(CNPJ[10]) * 4) +
    (StrToInt(CNPJ[11]) * 3) + (StrToInt(CNPJ[12]) * 2);
  Soma := Soma * 10;
  Digito1 := Soma mod 11;
  if Digito1 = 10 then
    Digito1 := 0;
  { compara o resultado com o 1o. digito informado }
  if Digito1 = StrToInt(CNPJ[13]) then
  begin
    { se correto ... }
    { calcula o 2o. dígito }
    Soma := (StrToInt(CNPJ[01]) * 6) + (StrToInt(CNPJ[02]) * 5) +
      (StrToInt(CNPJ[03]) * 4) + (StrToInt(CNPJ[04]) * 3) +
      (StrToInt(CNPJ[05]) * 2) + (StrToInt(CNPJ[06]) * 9) +
      (StrToInt(CNPJ[07]) * 8) + (StrToInt(CNPJ[08]) * 7) +
      (StrToInt(CNPJ[09]) * 6) + (StrToInt(CNPJ[10]) * 5) +
      (StrToInt(CNPJ[11]) * 4) + (StrToInt(CNPJ[12]) * 3) +
      (StrToInt(CNPJ[13]) * 2);
    Soma := Soma * 10;
    Digito2 := Soma mod 11;
    if Digito2 = 10 then
      Digito2 := 0;
    { compara o resultado com o 2o. digito informado }
    if (Digito2 = StrToInt(CNPJ[14])) and (Soma > 0) then
      Result := True;
  end;
end;

end.
